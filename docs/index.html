<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="cache-control" content="max-age=0"/>
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
        <meta http-equiv="pragma" content="no-cache" />
        <meta name="viewport" content="width=350">

        <style>
            body {
                width: 100%;
            }
            #main {
                margin: 0 auto;
                border-collapse: separate;
                border-spacing: 1px;
                background-color: blue;
            }

            #main td {
                background-color: black;
            }

            #main td.wall {
                background-color: gray;
            }

            #main td.figure1 {
                background-color: red;
            }

            #main td.figure2 {
                background-color: blue;
            }

            #main td.figure3 {
                background-color: green;
            }

            #main td.figure4 {
                background-color: yellow;
            }

            #main td.figure5 {
                background-color: white;
            }

            #main td.figure6 {
                background-color: orange;
            }

            #main td.figure7 {
                background-color: cyan;
            }
        </style>
        
        <script>
            document.addEventListener("DOMContentLoaded", () => { 
                function init() {
                    var cellSize = window.innerHeight/25;
                    var table = document.getElementById("main");

                    var rowIndex = 0;
                    while (rowIndex < 20){
                        var row = table.insertRow(table.rows.length);

                        var cell = row.insertCell(row.length);
                        cell.style.height = cellSize;
                        cell.style.width = cellSize;
                        cell.classList.add("wall");
                        
                        var cellIndex = 0;
                        while (cellIndex < 10){
                            var cell = row.insertCell(row.length);
                            cell.style.height = cellSize;
                            cell.style.width = cellSize;
                            cellIndex = cellIndex + 1;
                        }

                        var cell = row.insertCell(row.length);
                        cell.style.height = cellSize;
                        cell.style.width = cellSize;
                        cell.classList.add("wall");

                        rowIndex = rowIndex + 1;
                    }

                    var row = table.insertRow(table.rows.length);
                    var cellIndex = 0;
                    while (cellIndex < 12){       
                        var cell = row.insertCell(row.length);
                        cell.style.height = cellSize;
                        cell.style.width = cellSize;
                        cell.classList.add("wall");

                        cellIndex = cellIndex + 1;
                    }

                    return table;
                }

                function showFigure(show) {
                    var tileIndex = 0;
                    while (tileIndex < figure.figureType.offsets.length){
                        var tile = figure.figureType.offsets[tileIndex];
                        var rotatedTile = rotates[figure.rotate](tile);

                        if (show) {
                            table
                                .rows[figure.position.y + rotatedTile.y]
                                .cells[figure.position.x + rotatedTile.x]
                                .classList
                                .add(figure.figureType.class)
                            ;
                        } else {
                            table
                                .rows[figure.position.y + rotatedTile.y]
                                .cells[figure.position.x + rotatedTile.x]
                                .classList
                                .remove(figure.figureType.class)
                            ;
                        }

                        tileIndex = tileIndex + 1;
                    }
                } 

                var table = init();

                var figureTypes = [
                    { class: "figure1", offsets: [{x: 0, y: 0}, {x: 1, y: 0}, {x: 0, y: 1}, {x: 1, y: 1}]},
                    { class: "figure2", offsets: [{x: 0, y: 0}, {x: 1, y: 0}, {x: 0, y: 1}, {x:-1, y: 1}]},
                    { class: "figure3", offsets: [{x: 0, y:-1}, {x: 0, y: 0}, {x: 0, y: 1}, {x: 0, y: 2}]},
                    { class: "figure4", offsets: [{x: 0, y: 0}, {x:-1, y: 0}, {x: 0, y: 1}, {x: 1, y: 1}]},
                    { class: "figure5", offsets: [{x: 0, y: 0}, {x:-1, y: 0}, {x: 1, y: 0}, {x: 0, y: 1}]},
                    { class: "figure6", offsets: [{x: 0, y: 0}, {x:-1, y: 0}, {x: 0, y:-1}, {x: 0, y:-2}]},
                    { class: "figure7", offsets: [{x: 0, y: 0}, {x: 1, y: 0}, {x: 0, y:-1}, {x: 0, y:-2}]},
                ];

                var rotates = [
                    (tile) => ({ x: tile.x, y: tile.y }),
                    (tile) => ({ x:-tile.y, y: tile.x }),
                    (tile) => ({ x:-tile.x, y:-tile.y }),
                    (tile) => ({ x: tile.y, y:-tile.x })
                ];
/*
                var figures = [
                    { position: { x: 5, y: 5 }, figureType: figureTypes[0] },
                    { position: { x: 5, y: 9 }, figureType: figureTypes[1] },
                    { position: { x: 5, y: 14 }, figureType: figureTypes[2] },
                    { position: { x: 2, y: 3 }, figureType: figureTypes[3] },
                    { position: { x: 7, y: 3 }, figureType: figureTypes[4] },
                    { position: { x: 2, y: 7 }, figureType: figureTypes[5] },
                    { position: { x: 3, y: 8 }, figureType: figureTypes[6] },
                ];

                var figureIndex = 0;
                while (figureIndex < figures.length) {
                    var figure = figures [figureIndex];

                    showFigure(figure);
                    figureIndex = figureIndex + 1;
                }
*/

                var figure = { 
                    position: { x: 5, y: 14 }, 
                    rotate: 0,
                    figureType: figureTypes[2] 
                };
                showFigure(true);

                document.addEventListener("keydown", (e) => {
                    e = e || window.event;
                    if (e.keyCode === 37){
                        showFigure(false);

                        figure.position.x = figure.position.x - 1;

                        showFigure(true);
                    }
                    if (e.keyCode === 39){
                        showFigure(false);

                        figure.position.x = figure.position.x + 1;

                        showFigure(true);
                    }
                    if (e.keyCode === 38){
                        showFigure(false);

                        figure.rotate = (figure.rotate + 1) % 4;

                        showFigure(true);
                    }

                });
            });
        </script>
    </head>
    <body>
        <table id = "main">

        </table>        
    </body>
</html>